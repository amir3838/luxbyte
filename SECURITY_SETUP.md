# LUXBYTE Security Setup Guide
## ุฏููู ุฅุนุฏุงุฏ ุงูุฃูุงู

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุชุทุจูู ุณูุงุณุงุช ุงูุฃูุงู ุงููุงููุฉ ูู LUXBYTE.

---

## ๐ 1. ุชุทุจูู ุณูุงุณุงุช RLS

### ุงูุฎุทูุฉ 1: ุชุทุจูู ุงูุณูุงุณุงุช ูู Supabase

1. ุงูุชุญ **Supabase Dashboard** โ **SQL Editor**
2. ุงูุณุฎ ูุงูุตู ูุญุชูู `supabase/rls_policies_final.sql`
3. ุงุถุบุท **Run** ูุชุทุจูู ุฌููุน ุงูุณูุงุณุงุช

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุชุทุจูู

```sql
-- ูุญุต ุญุงูุฉ RLS
SELECT
    tablename,
    rowsecurity as rls_enabled
FROM pg_tables
WHERE schemaname = 'public'
AND tablename IN ('documents', 'profiles', 'business_requests')
ORDER BY tablename;
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```
tablename         | rls_enabled
------------------|------------
business_requests | true
documents         | true
profiles          | true
```

---

## ๐งช 2. ุงุฎุชุจุงุฑ ุงูุฃูุงู

### ุงุฎุชุจุงุฑ 1: ุฅูุดุงุก ูุณุชุฎุฏููู ุชุฌุฑูุจููู

1. ูู **Supabase Dashboard** โ **Authentication** โ **Users**
2. ุฃูุดุฆ ูุณุชุฎุฏููู ุชุฌุฑูุจููู:
   - **User 1:** test1@example.com
   - **User 2:** test2@example.com

### ุงุฎุชุจุงุฑ 2: ุงุฎุชุจุงุฑ RLS

1. ุงูุชุญ **SQL Editor**
2. ุงูุณุฎ ูุงูุตู ูุญุชูู `supabase/test_rls.sql`
3. ุงุณุชุจุฏู `auth.uid()` ุจูุนุฑู ุงููุณุชุฎุฏู ุงูุญูููู
4. ุดุบู ุงูุงุฎุชุจุงุฑุงุช

### ุงุฎุชุจุงุฑ 3: ุงุฎุชุจุงุฑ ุงูุฑูุน

1. ุณุฌู ุงูุฏุฎูู ูู **User 1**
2. ุงุฑูุน ููู (ูุฌุจ ุฃู ููุฌุญ)
3. ุณุฌู ุงูุฏุฎูู ูู **User 2**
4. ุญุงูู ุงููุตูู ููููุงุช User 1 (ูุฌุจ ุฃู ููุดู)

---

## ๐ 3. ุงููุดุฑ ุงูุขูู

### ูุฑุญูุฉ ุงููุนุงููุฉ (Preview)

```bash
# ุณุญุจ ุฅุนุฏุงุฏุงุช ุงููุนุงููุฉ
vercel pull --environment=preview

# ูุดุฑ ุงููุนุงููุฉ
vercel deploy --prebuilt

# ุงุฎุชุจุงุฑ ุงููุนุงููุฉ
npm run test:smoke
```

### ูุฑุญูุฉ ุงูุฅูุชุงุฌ (Production)

```bash
# ุณุญุจ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
vercel env pull .env

# ูุดุฑ ุงูุฅูุชุงุฌ
vercel deploy --prod

# ุงุฎุชุจุงุฑ ุงูุฅูุชุงุฌ
npm run test:smoke
```

---

## ๐ 4. ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงูุขููุฉ

ุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ุงููุชุบูุฑุงุช ูู Vercel:

### ูุชุบูุฑุงุช ูุทููุจุฉ:
```
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

### ูุชุบูุฑุงุช ุงุฎุชูุงุฑูุฉ:
```
FIREBASE_API_KEY=your_firebase_key
FIREBASE_AUTH_DOMAIN=your_firebase_domain
```

---

## ๐ 5. ูุงุฆูุฉ ุงูุชุญูู ุงูุฃููู

### ูุจู ุงููุดุฑ:
- [ ] ุชุทุจูู RLS policies
- [ ] ุงุฎุชุจุงุฑ RLS ูุน ูุณุชุฎุฏููู ูุฎุชูููู
- [ ] ุงุฎุชุจุงุฑ ุฑูุน ุงููููุงุช
- [ ] ุงุฎุชุจุงุฑ API endpoints
- [ ] ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ููุงุชูุญ ููุดููุฉ
- [ ] ุงุฎุชุจุงุฑ CSP headers
- [ ] ุงุฎุชุจุงุฑ SPA routing

### ุจุนุฏ ุงููุดุฑ:
- [ ] ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู
- [ ] ุงุฎุชุจุงุฑ ุฑูุน ููู
- [ ] ุงุฎุชุจุงุฑ ุนุฑุถ ุงูุจูุงูุงุช
- [ ] ุงุฎุชุจุงุฑ ุงูุฃูุงู (ูุญุงููุฉ ุงููุตูู ูุจูุงูุงุช ุงูุขุฎุฑูู)
- [ ] ูุฑุงูุจุฉ logs ููุฃุฎุทุงุก

---

## ๐ก๏ธ 6. ุณูุงุณุงุช ุงูุฃูุงู ุงููุทุจูุฉ

### ุฌุฏุงูู ุงูุจูุงูุงุช:
- **documents:** ุงููุณุชุฎุฏู ูุฑู ูุณุชูุฏุงุชู ููุท
- **profiles:** ุงููุณุชุฎุฏู ูุฑู ูููู ุงูุดุฎุตู ููุท
- **business_requests:** ุงููุณุชุฎุฏู ูุฑู ุทูุจุงุชู ููุท

### ุงูุชุฎุฒูู:
- **kyc_docs:** ุงููุณุชุฎุฏู ูุฑูุน ูู ูุฌูุฏู ููุท
- **Public URLs:** ุขููุฉ ูุน ูููุฏ ุงููุฌูุฏ
- **Admin Access:** ุงููุฏูุฑูู ูููููู ุงููุตูู ููู ุดูุก

### API:
- **Authentication:** ูุทููุจ ูุฌููุน ุงูุนูููุงุช
- **Authorization:** RLS ูุชุญูู ูู ุงููุตูู
- **CORS:** ูุญุฏูุฏ ููููุงูุน ุงููุณููุญุฉ

---

## ๐จ 7. ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: "RLS policy violation"
**ุงูุญู:** ุชุฃูุฏ ูู ุชุทุจูู ุงูุณูุงุณุงุช ุงูุตุญูุญุฉ

### ูุดููุฉ: "File upload failed"
**ุงูุญู:** ุชุญูู ูู ุณูุงุณุงุช ุงูุชุฎุฒูู ููุฌูุฏ ุงููุณุชุฎุฏู

### ูุดููุฉ: "403 Forbidden"
**ุงูุญู:** ุชุญูู ูู authentication ูRLS policies

### ูุดููุฉ: "CORS error"
**ุงูุญู:** ุชุญูู ูู ุฅุนุฏุงุฏุงุช CORS ูู vercel.json

---

## ๐ 8. ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. ุชุญูู ูู **Supabase Logs**
2. ุชุญูู ูู **Vercel Logs**
3. ุดุบู `npm run test:smoke`
4. ุฑุงุฌุน ููู `QUICK_CHECK_RESULTS.md`

---

**ุชู ุฅุนุฏุงุฏ ุงูุฃูุงู ุจูุฌุงุญ!** ๐โ
